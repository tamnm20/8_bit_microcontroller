C51 COMPILER V9.60.7.0   F580_BLINKY                                                       07/16/2024 14:58:31 PAGE 1   


C51 COMPILER V9.60.7.0, COMPILATION OF MODULE F580_BLINKY
OBJECT MODULE PLACED IN F580_Blinky.OBJ
COMPILER INVOKED BY: C:\Keil\C51\BIN\c51.exe F580_Blinky.c DB OE BR INCDIR(C:\SiLabs\MCU\Inc)

line level    source

   1          //-----------------------------------------------------------------------------
   2          // F580_Blinky.c
   3          //-----------------------------------------------------------------------------
   4          // Copyright (C) 2009 Silicon Laboratories, Inc.
   5          // http://www.silabs.com
   6          //
   7          // Program Description:
   8          //
   9          // This program flashes the green LED on the C8051F580 target board about
  10          // five times a second using the interrupt handler for Timer2.
  11          //
  12          //
  13          // How To Test:
  14          //
  15          // 1) Download code to the 'F580 target board
  16          // 2) Ensure that the P1.3 pins are shorted together on the J19 header
  17          // 3) Run the program.  If the LED flashes, the program is working
  18          //
  19          //
  20          // Target:         C8051F500 (Side A of a C8051F580-TB)
  21          // Tool chain:     Keil C51 8.0 / Keil EVAL C51
  22          // Command Line:   None
  23          //
  24          // Release 1.0 / 19 FEB 2009 (GP)
  25          //    -Initial Revision
  26          
  27          //-----------------------------------------------------------------------------
  28          // Includes
  29          //-----------------------------------------------------------------------------
  30          
  31          #include <compiler_defs.h>             // Compiler declarations
  32          #include <C8051F580_defs.h>            // SFR declarations
  33          #include "F580_Blinky_Init.h>
  34          
  35          //-----------------------------------------------------------------------------
  36          // Global Constants
  37          //-----------------------------------------------------------------------------
  38          
  39          #define SYSCLK       24000000       // SYSCLK frequency in Hz
  40          
  41          //-----------------------------------------------------------------------------
  42          // Pin Defintions
  43          //-----------------------------------------------------------------------------
  44          
  45          SBIT(LED, SFR_P2, 0);                  // LED='1' means ON
  46          U32 num = 0;
  47          void delayms(int time);
  48          //-----------------------------------------------------------------------------
  49          // Main Routine
  50          //-----------------------------------------------------------------------------
  51          void main (void)
  52          {
  53   1         SFRPAGE = ACTIVE_PAGE;
  54   1      
  55   1         PCA0MD &= ~0x40;                    // Disable the watchdog timer
C51 COMPILER V9.60.7.0   F580_BLINKY                                                       07/16/2024 14:58:31 PAGE 2   

  56   1      
  57   1         OSCILLATOR_Init ();                 // Configure system clock
  58   1      
  59   1         PORT_Init ();                       // Initialize crossbar
  60   1      
  61   1         TIMER2_Init (SYSCLK / 12 / 10000);     // Init Timer2 to generate interrupts
  62   1                                             // at a 10 Hz rate.
  63   1      
  64   1         EA = 1;                             // Enable global interrupts
  65   1      
  66   1         while (1) {
  67   2          LED = !LED;
  68   2              delayms(1000);
  69   2         }                        // Spin forever
  70   1      }
  71          
  72          //-----------------------------------------------------------------------------
  73          // Interrupt Service Routines
  74          //-----------------------------------------------------------------------------
  75          
  76          //-----------------------------------------------------------------------------
  77          // Timer2_ISR
  78          //-----------------------------------------------------------------------------
  79          //
  80          // This routine changes the state of the LED whenever Timer2 overflows.
  81          //
  82          //-----------------------------------------------------------------------------
  83          
  84          INTERRUPT(Timer2_ISR, INTERRUPT_TIMER2)
  85          {
  86   1         TF2H = 0;                           // Clear Timer2 interrupt flag
  87   1         num++;
  88   1      }
  89          void delayms(int time)
  90          {
  91   1         //volatile int tmp = num;
  92   1         num = 0;
  93   1         while(num < time);
  94   1      }
  95          
  96          //-----------------------------------------------------------------------------
  97          // End Of File
  98          //-----------------------------------------------------------------------------


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    102    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =      4    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
