C51 COMPILER V9.51   MAIN                                                                  07/17/2024 13:47:13 PAGE 1   


C51 COMPILER V9.51, COMPILATION OF MODULE MAIN
OBJECT MODULE PLACED IN .\Objects\main.obj
COMPILER INVOKED BY: C:\Keil\C51\BIN\C51.EXE main.c LARGE OMF2 ROM(COMPACT) OPTIMIZE(8,SPEED) BROWSE ORDER DEBUG PRINT(.
                    -\Listings\main.lst) TABS(2) OBJECT(.\Objects\main.obj)

line level    source

   1          #include <compiler_defs.h>             // Compiler declarations
   2          #include <C8051F580.h>
*** WARNING C317 IN LINE 34 OF C:\Keil\C51\Inc\Cygnal\C8051F580.h: attempt to redefine macro 'SFR'
*** WARNING C317 IN LINE 35 OF C:\Keil\C51\Inc\Cygnal\C8051F580.h: attempt to redefine macro 'SFR16'
*** WARNING C317 IN LINE 36 OF C:\Keil\C51\Inc\Cygnal\C8051F580.h: attempt to redefine macro 'SBIT'
   3          #include <string.h>
   4          //-----------------------------------------------------------------------------
   5          // Global CONSTANTS
   6          //-----------------------------------------------------------------------------
   7          #define SYSCLK       24000000        // SYSCLK frequency in Hz
   8          SBIT(TEST, P1, 3);
   9          //-----------------------------------------------------------------------------
  10          // Function PROTOTYPES
  11          //-----------------------------------------------------------------------------
  12          void SYSTEM_Init (void);
  13          void PORT_Init (void);
  14          void PCA0_Init (void);
  15          void delay(U16 ms);
  16          void delay_test(U16 test);
  17          //----------------------------------------------------------------------------
  18          // MAIN Routine
  19          //-----------------------------------------------------------------------------
  20          void main (void)
  21          {
  22   1          SFRPAGE = ACTIVE_PAGE;
  23   1          PCA0MD &= ~(1 << 6);                   // Disable the watchdog timer
  24   1          SYSTEM_Init();                        // Configure system clock
  25   1          PORT_Init ();                           // Congigure pin
  26   1          PCA0_Init();
  27   1          EA = 1;                                 // Enable global interrupts
  28   1         while (1)
  29   1         {
  30   2         }                        
  31   1      }
  32          void SYSTEM_Init(void)
  33          {
  34   1         U8 SFRPAGE_save = SFRPAGE;
  35   1         SFRPAGE = CONFIG_PAGE;
  36   1         CLKSEL &= ~(3<< 0) ;       // choose internal oscillator   
  37   1         OSCICN |= (2<<6) | (7<<0); // congig clock internal oscillator devided by 1
  38   1         SFRPAGE = SFRPAGE_save;
  39   1      }
  40          void PORT_Init (void)
  41          {
  42   1            U8 SFRPAGE_save = SFRPAGE;
  43   1            SFRPAGE = CONFIG_PAGE;
  44   1            
  45   1            P1MDOUT |= (1<<3);    // Push-pull
  46   1            P0SKIP    = 0xFF;
  47   1            P1SKIP    = 0x07;
  48   1            XBR1    = 1<<2 ;
  49   1            //XBR1    = 1<<1;
  50   1            XBR2    |= (1<<6);    // Enable crossbar and weak pull-ups
  51   1      
C51 COMPILER V9.51   MAIN                                                                  07/17/2024 13:47:13 PAGE 2   

  52   1            SFRPAGE = SFRPAGE_save;
  53   1      }
  54          
  55          void PCA0_Init (void){
  56   1            U8 SFRPAGE_save = SFRPAGE;
  57   1            SFRPAGE = ACTIVE_PAGE;
  58   1            PCA0CN = 0x00;          // Stop counter; clear all flags
  59   1            PCA0MD |= (1 << 3); // PCA0 pulse select system clock/12
  60   1            //PCA0CPM0
  61   1            PCA0CPM0 |= (1<<2) | (1<<1) ;
  62   1            PCA0CPH0 = ((SYSCLK) / ((U32) 2* (U32)4000000));
  63   1            PCA0CN |= 1 << 6; //  PCA0 Counter/Timer enabled.
  64   1            SFRPAGE = SFRPAGE_save;
  65   1      }
  66          
  67          


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =     78    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
   EDATA SIZE       =   ----    ----
   HDATA SIZE       =   ----    ----
   XDATA CONST SIZE =   ----    ----
   FAR CONST SIZE   =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  3 WARNING(S),  0 ERROR(S)
